<div class="main-container-body tab-content">
    <div class="tab-pane active cluster-nodes" id="service-list" data-ng-show="cluster.nodes.length">
        <div class="input-group col-xs-4 search-container">
            <div class="input-group">
                <input type="text" class="form-control" ng-model="searchKeyWord" name="searchKeyWord"
                       placeholder="输入标签名称搜索主机" my-enter="doSearch(searchKeyWord)">
                <div class="input-group-addon" ng-click="doSearch(searchKeyWord)"><i class="icon icon-search"></i>搜索
                </div>
            </div>
        </div>
        <div>
            <button type="button" class="btn btn-default btn-sm" data-ng-click="refresh()">刷新</button>
            <button type="button" class="btn btn-default btn-sm"
                data-ui-sref="cluster.nodesource({clusterId:cluster.id})">
              添加主机
            </button>
            <button type="button" class="btn btn-default btn-sm" data-ng-click="deleteNodes(checkedNodes.value)"
                    data-ng-disabled="!checkedNodes.value.length" data-demo-disable>删除主机
            </button>&nbsp;
            <div class="btn-group btn-dropdown-info" data-ng-show="!statusMgr.nodeStatusCount[cluster.id]['upgrading'] && statusMgr.nodeOldVersionCount[cluster.id].total">
                  <button type="button" class="btn btn-warning btn-sm" data-ng-click="upgradeNode(cluster.id)" data-demo-disable>升级服务
                        <span class="badge" data-ng-bind="statusMgr.nodeOldVersionCount[cluster.id].total"></span>
                  </button>
                  <button type="button" class="btn btn-warning btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="caret"></span>
                    <span class="sr-only">Toggle Dropdown</span>
                  </button>
                  <ul class="dropdown-menu">
                    <li data-ng-repeat="(name, _) in statusMgr.nodeOldVersionCount[cluster.id].widgets">{/getServiceLabel(name)/}
                        <span class="badge" data-ng-bind="statusMgr.nodeOldVersionCount[cluster.id][name]"></span>
                    </li>
                  </ul>
            </div>
            <div class="btn-group btn-dropdown-info" data-ng-show="statusMgr.nodeStatusCount[cluster.id]['upgrading']">
                  <button type="button" class="btn btn-warning btn-sm" disabled="disabled">升级中
                      <span class="badge" data-ng-bind="statusMgr.nodeOldVersionCount[cluster.id].total"></span>
                  </button>
                  <button type="button" class="btn btn-warning btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="caret"></span>
                    <span class="sr-only">Toggle Dropdown</span>
                  </button>
                  <ul class="dropdown-menu">
                    <li data-ng-repeat="(name, _) in statusMgr.nodeOldVersionCount[cluster.id].widgets">{/getServiceLabel(name)/}
                        <span class="badge" data-ng-bind="statusMgr.nodeOldVersionCount[cluster.id][name]"></span>
                    </li>
                  </ul>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th><input type="checkbox" data-ckb-batch-all="checkedNodes"></th>
                    <th>名称</th>
                    <th>类型</th>
                    <th>IP地址</th>
                    <th>运行状态</th>
                    <th>Agent版本</th>
                    <th>创建时间</th>
                    <th>更新时间</th>
                </tr>
                </thead>
                <tbody>
                <tr data-ng-repeat="node in contentCurPage">
                    <td>
                        <input type="checkbox" data-ckb-batch="checkedNodes" data-ng-value="node">
                    </td>
                    <td class="agent-version">
                        <span><a data-ui-sref="cluster.nodedetails({nodeId:node.id, clusterId:cluster.id})">{/ node.name /}</a>
                            <em class="label label-danger" data-ng-show="upgradeFailedNodes[node.id]">
                                升级失败
                            </em>
                        </span>
                    </td>
                    <td>
                        <span class="bg-primary" data-ng-show="getIsMaster(node)">MASTER</span><span class="bg-primary" data-ng-repeat="attr in node.attributes">{/ nodeAttributes[attr.attribute] /}</span>
                    </td>
                    <td>
                        {/ node.ip/}
                    </td>
                    <td>
                        <img data-ng-src="../pics/ico-node-status-{/statusMgr.nodes[node.id].status/}.png" width="16"> {/statName[statusMgr.nodes[node.id].status]/}
                    </td>
                    <td>
                        {/ statusMgr.nodes[node.id].services.agent.version /}
                    </td>
                    <td>
                        {/ node.created_at /}
                    </td>
                    <td>
                        {/ node.updated_at /}
                    </td>
                </tr>
                </tbody>
            </table>
            <div class="alert alert-warning text-center" ng-show="!contentCurPage.length">
                未查询到符合条件的主机
            </div>
        </div>

        <uib-pagination total-items="totalItems" items-per-page="20" ng-model="currentPage" ng-change="pageChanged()" data-ng-show="showPagination" previous-text="上一页" next-text="下一页"></uib-pagination>
    </div>
    <div data-ng-show="showCreateNode">
        <h4>
            集群中没有主机，
            <a data-ui-sref="cluster.nodesource({clusterId:cluster.id})">添加主机</a>
        </h4>
    </div>
</div>
