<div class="page-header">
    <div>
        <h1 class="pull-left">应用部署</h1>
    </div>
</div>

<section>
    <div class="main-container">
        <header class="clearfix">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#config" data-toggle="tab">基本信息</a></li>
                <li><a href="#detail" data-toggle="tab">详情</a></li>
            </ul>
        </header>
        <div class="main-container-body">
            <div class="tab-content">
                <div class="tab-pane active" id="config">
                    <div class="main-container">
                        <div class="main-container-body">
                            <form class="form-horizontal" name="staticForm">
                                <div class="form-group">
                                    <label class="col-md-2 control-label"><span class="text-danger">*</span>
                                        应用名称</label>
                                    <div class="col-md-5">
                                        <input type="text" class="form-control"
                                               data-ng-model="repoDetailCtrl.form.app.appName" data-required="required">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label"><span class="text-danger">*</span>
                                        应用版本</label>
                                    <div class="col-md-5">
                                        <select class="form-control"
                                                data-ng-options="tag.version as tag.version for tag in repoDetailCtrl.tags"
                                                data-ng-model="repoDetailCtrl.form.app.imageVersion"
                                                data-required="required">
                                            <option value="">--- 选择应用版本 ---</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label">
                                        <span class="text-danger">* </span>
                                        选择集群
                                    </label>
                                    <div class="col-md-5">
                                        <select class="form-control"
                                                data-ng-model="repoDetailCtrl.form.app.clusterId"
                                                data-ng-options="cluster.id as cluster.name for cluster in repoDetailCtrl.clusters"
                                                data-required="required"
                                        >
                                            <option value="">--- 选择应用将要运行在哪个集群上 ---</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- 容器规格 -->
                                <div class="form-group">
                                    <label class="col-md-2 control-label">
                                        <span class="text-danger">* </span>
                                        容器规格
                                    </label>

                                    <div class="col-md-5">
                                        <rzslider
                                                rz-slider-model="repoDetailCtrl.cpuSlideValue"
                                                rz-slider-options="repoDetailCtrl.containerConfig.cpu.options"
                                                style="width: 70%; float: left;"></rzslider>
                                        <span style="display: inline-block; margin-top: 10px; margin-left: 12px;">
                                            <strong style="font-size: 30px;">
                                                {/repoDetailCtrl.form.app.cpus/}
                                            </strong>
                                        </span>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="col-md-5 col-md-offset-2">
                                        <rzslider
                                                rz-slider-model="repoDetailCtrl.memSlideValue"
                                                rz-slider-options="repoDetailCtrl.containerConfig.mem.options"
                                                style="width: 70%; float: left;"></rzslider>
                                        <span style="display: inline-block; margin-top: 10px; margin-left: 12px;">
                                            <strong style="font-size: 30px;">
                                                {/repoDetailCtrl.form.app.mem/}
                                            </strong>
                                            <sub>MB</sub>
                                        </span>
                                    </div>
                                </div>

                                <!--  容器个数 -->
                                <div class="form-group">
                                    <label class="col-md-2 control-label">
                                        <span class="text-danger">* </span>
                                        容器个数
                                    </label>

                                    <div class="col-md-2"
                                         data-ng-class="{ 'has-error' : staticForm.instances.$invalid && !staticForm.instances.$pristine }">
                                        <input type="number" class="form-control"
                                               name="instances"
                                               data-ng-model="repoDetailCtrl.form.app.instances"
                                               data-min="1"
                                               data-required="required">

                                        <div data-ng-class="{ 'has-error' : staticForm.instances.$invalid && !staticForm.instances.$pristine }">
                                            <p data-ng-show="staticForm.instances.$error.min && !staticForm.instances.$pristine"
                                               class="help-block">容器个数不小于 1 </p>

                                            <p data-ng-show="staticForm.instances.$error.required && !staticForm.instances.$pristine"
                                               class="help-block">容器个数不能为空 </p>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group" data-ng-show="repoDetailCtrl.questions.length">
                                    <label class="col-md-2 control-label">配置</label>
                                    <div class="col-md-5">
                                        <dynamic-field field-data="fieldData"
                                                       ng-repeat="fieldData in repoDetailCtrl.questions"></dynamic-field>
                                    </div>
                                </div>
                                <hr>
                                <div class="form-group">
                                    <div class="col-md-offset-2 col-md-5">
                                        <button type="submit" class="btn btn-primary btn-block"
                                                ng-disabled="staticForm.$invalid"
                                                data-ng-click="repoDetailCtrl.deploy()">部 署
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="tab-pane" id="detail">
                    <div class="alert alert-warning text-center" data-ng-if="!repoDetailCtrl.markdown">
                        暂无详情
                    </div>
                    <div btf-markdown="repoDetailCtrl.markdown">
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>