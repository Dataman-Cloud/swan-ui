<div class="page-header">
    <h1>应用管理</h1>
    <small>应用管理功能主要负责部署应用和管理应用的生命周期。<br>可以添加、删除、启动、停止应用，还可以弹性扩展应用实例数量。<br><a
            data-ng-if="!IS_OFF_FLAG" ng-cloak href="http://doc.shurenyun.com/practice/wordpress.html" target="_blank">
        如何搭建 Wordpress 个人博客</a></small>
    <a data-ui-sref="appcreate" class="btn btn-success" data-demo-disable="left">新建应用</a>
</div>
<section>
    <div class="main-container">
        <div class="main-container-body">
            <div class="input-group col-xs-4 search-container">
                <div class="input-group">
                    <input type="text" class="form-control" ng-model="searchKeyWord" name="searchKeyWord"
                           placeholder="输入应用名称进行搜索" my-enter="listappctrl.doSearch(searchKeyWord)">
                    <div class="input-group-addon" ng-click="listappctrl.doSearch(searchKeyWord)"><i
                            class="icon icon-search"></i>搜索
                    </div>
                </div><!-- /input-group -->
            </div>
            <table ng-table="listappctrl.appListTable" template-pagination="/views/common/ngTablePage.html"
                   class="table table-striped" ng-table-columns-binding="boundCols">
                <tbody>
                <tr ng-repeat="app in listappctrl.applist">
                    <td data-title="'应用名称'" sortable="'name'"><a href="#"
                                                                 data-ui-sref="appdetails.config({cluster_id: app.cid ,app_id: app.id})">{/app.name/}</a>
                    </td>
                    <td data-title="'当前状态'">{/listappctrl.APP_STATUS[listappctrl.appListStatus[app.id].status]/}</td>
                    <td data-title="'更新时间'" sortable="'updated'">{/app.update | date:"yyyy-MM-dd HH:mm:ss"/}</td>
                    <td data-title="'所属集群'" id="appTdCluster">
                        <a href="#" data-ui-sref="cluster.clusterdetails.nodes({clusterId:app.cid})"
                           ng-class="{'danger': listappctrl.appListStatus[app.id].status == '10'}"> <img
                                data-ng-src="../pics/ico-applist-cluster-failed.png" width="16"
                                ng-show="listappctrl.appListStatus[app.id].status == '10'">
                            {/listappctrl.clusterNameMap[app.cid]/}
                        </a>
                    </td>
                    <td data-title="'容器个数'" sortable="'instances'"><span
                            ng-show="listappctrl.appListStatus[app.id].tasks != undefined && listappctrl.appListStatus[app.id].tasks != app.instances">{/listappctrl.appListStatus[app.id].tasks/}/{/app.instances/}</span>
                        <span ng-show="listappctrl.appListStatus[app.id].tasks == app.instances">{/app.instances/}</span>
                    </td>
                    <td data-title="'操作'">
                        <button type="button"
                                data-ng-disabled="listappctrl.appListStatus[app.id].status != '2' && listappctrl.appListStatus[app.id].status != '3'"
                                data-toggle="modal" data-target="#app-upContainer"
                                data-ng-click="listappctrl.upContainerModal(app.cid, app.id, app.instances)"
                                class="btn btn-default btn-xs" data-demo-disable>扩展
                        </button>
                        <button type="button"
                                data-ng-disabled="listappctrl.appListStatus[app.id].status != '2'"
                                class="btn btn-default btn-xs"
                                data-ng-click="listappctrl.stop(app.cid, app.id)"
                                data-ng-show="listappctrl.appListStatus[app.id].status!='3'" data-demo-disable>停止
                        </button>
                        <button type="button"
                                data-ng-disabled="listappctrl.appListStatus[app.id].status != '3'"
                                class="btn btn-default btn-xs"
                                data-ng-click="listappctrl.start(app.cid, app.id)"
                                data-ng-show="listappctrl.appListStatus[app.id].status == '3'" data-demo-disable>启动
                        </button>
                        <button type="button" class="btn btn-default btn-xs"
                                data-ng-click="listappctrl.undo(app.cid, app.id)"
                                data-ng-show="listappctrl.appListStatus[app.id].status == '6'" data-demo-disable>撤销
                        </button>
                        <button type="button"
                                data-ng-disabled="listappctrl.appListStatus[app.id].status == '5' || listappctrl.appListStatus[app.id].status == 'undefined'"
                                data-ng-click="listappctrl.delete(app.cid, app.id)" class="btn btn-default btn-xs"
                                data-demo-disable>删除
                        </button>
                        <button type="button"
                                data-ng-disabled="listappctrl.appListStatus[app.id].status != '9'"
                                class="btn btn-default btn-xs"
                                data-ng-click="listappctrl.redeploy(app.cid, app.id)"
                                data-ng-show="listappctrl.appListStatus[app.id].status =='9'" data-demo-disable>恢复
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
            <div class="alert alert-warning text-center" data-ng-show="showNothtingAlert">
                未查询到应用数据
            </div>
        </div>
    </div>
</section>
